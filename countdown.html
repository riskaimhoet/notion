<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>7DREAM Countdown</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<style>
* {box-sizing: border-box;margin: 0;padding: 0;font-family: 'JetBrains Mono', monospace;}
body {
  background: transparent;
  color: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
}
h1 {
  font-size: 1.8rem;
  letter-spacing: 0.3rem;
  text-align: center;
  margin-bottom: 1.5rem;
}
.separator {
  width: 50px;
  height: 3px;
  background: rgba(255,255,255,0.3);
  border-radius: 3px;
  margin-bottom: 2rem;
  cursor: pointer;
  transition: opacity 0.2s ease;
}
.separator:hover {opacity: 0.6;}
.countdown {
  display: flex;
  gap: 1rem;
}
.flip-card {
  background: #fff;
  border-radius: 10px;
  width: 110px;
  height: 120px;
  position: relative;
  color: #000;
  font-size: 3rem;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 5px 10px rgba(0,0,0,0.2);
  overflow: hidden;
}
.flip-card::before {
  content: "";
  position: absolute;
  top: 50%;
  left: 0;
  width: 100%;
  height: 2px;
  background: rgba(200,200,200,0.3);
  transform: translateY(-50%);
}
.label {
  text-align: center;
  margin-top: 0.5rem;
  color: #aaa;
  font-size: 0.9rem;
}
.flip {
  animation: flip 0.6s ease-in-out;
}
@keyframes flip {
  0% {transform: rotateX(0);}
  50% {transform: rotateX(-90deg);}
  100% {transform: rotateX(0);}
}
.info {
  margin-top: 2rem;
  font-size: 0.7rem;
  color: #777;
  text-align: center;
}
#editModal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%,-50%);
  background: rgba(30,30,30,0.95);
  padding: 1.5rem;
  border-radius: 12px;
  width: 320px;
  color: #fff;
  display: none;
  flex-direction: column;
  gap: 1rem;
}
#editModal h2 {font-size: 1rem;margin-bottom: 0.5rem;}
.event-row {
  display: flex;
  flex-direction: column;
  gap: 0.3rem;
  background: rgba(255,255,255,0.05);
  padding: 0.6rem;
  border-radius: 6px;
}
.event-row input {
  background: rgba(255,255,255,0.1);
  border: none;
  color: #fff;
  padding: 0.4rem;
  border-radius: 4px;
}
.event-row button {
  background: rgba(255,255,255,0.1);
  color: #fff;
  border: none;
  padding: 0.3rem;
  border-radius: 4px;
  cursor: pointer;
}
#unitSelect label {
  display: flex;
  align-items: center;
  gap: 0.4rem;
  font-size: 0.8rem;
}
.buttons {
  display: flex;
  justify-content: space-between;
}
button {
  background: rgba(255,255,255,0.1);
  color: #fff;
  border: none;
  padding: 0.5rem 0.8rem;
  border-radius: 6px;
  cursor: pointer;
  font-size: 0.8rem;
}
button:hover {background: rgba(255,255,255,0.2);}
.close-btn {
  position: absolute;
  top: 6px;
  right: 10px;
  background: none;
  border: none;
  color: #fff;
  font-size: 1.2rem;
  cursor: pointer;
}
</style>
</head>
<body>

<h1 id="eventTitle">7DREAM 10TH ANNIVERSARY</h1>
<div class="separator" id="editBtn"></div>
<div class="countdown" id="countdown"></div>

<div id="editModal">
  <button class="close-btn" id="closeModal">&times;</button>
  <h2>Events & Display</h2>
  <div id="eventList"></div>
  <div class="buttons">
    <button id="addEvent">+ Add Event</button>
    <button id="resetEvents">â†» Reset</button>
    <button id="saveEvents">Save</button>
  </div>
  <div id="unitSelect">
    <h3 style="margin-top:1rem;font-size:0.9rem;">Tampilkan unit</h3>
    <label><input type="checkbox" value="years" checked> Years</label>
    <label><input type="checkbox" value="months" checked> Months</label>
    <label><input type="checkbox" value="weeks" checked> Weeks</label>
    <label><input type="checkbox" value="days" checked> Days</label>
    <label><input type="checkbox" value="hours" checked> Hours</label>
    <label><input type="checkbox" value="minutes" checked> Minutes</label>
    <label><input type="checkbox" value="seconds" checked> Seconds</label>
  </div>
  <p style="font-size:0.8rem;margin-top:1rem;color:#999;text-align:right" id="timezone"></p>
</div>

<script>
const countdownContainer = document.getElementById('countdown');
const eventTitle = document.getElementById('eventTitle');
const editBtn = document.getElementById('editBtn');
const editModal = document.getElementById('editModal');
const closeModal = document.getElementById('closeModal');
const eventList = document.getElementById('eventList');
const addEventBtn = document.getElementById('addEvent');
const resetEventsBtn = document.getElementById('resetEvents');
const saveEventsBtn = document.getElementById('saveEvents');
const timezoneEl = document.getElementById('timezone');

timezoneEl.textContent = new Date().toLocaleString(undefined,{weekday:'long',year:'numeric',month:'long',day:'numeric',hour:'2-digit',minute:'2-digit'});

let events = JSON.parse(localStorage.getItem('events')) || [
  {name:"7DREAM 10TH ANNIVERSARY", date:"2025-12-10T09:46"}
];
let displayUnits = JSON.parse(localStorage.getItem('displayUnits')) || ["years","months","weeks","days","hours","minutes","seconds"];
let currentEventIndex = 0;
let prevValues = {};

function saveToLocalStorage(){
  localStorage.setItem('events', JSON.stringify(events));
  localStorage.setItem('displayUnits', JSON.stringify(displayUnits));
}

function openModal(){
  editModal.style.display = 'flex';
  renderEventList();
}

function closeModalFn(){
  editModal.style.display = 'none';
}

editBtn.onclick = openModal;
closeModal.onclick = closeModalFn;

addEventBtn.onclick = () => {
  events.push({name:"New Event", date:""});
  renderEventList();
};

resetEventsBtn.onclick = () => {
  events = [{name:"7DREAM 10TH ANNIVERSARY", date:"2025-12-10T09:46"}];
  displayUnits = ["years","months","weeks","days","hours","minutes","seconds"];
  saveToLocalStorage();
  renderEventList();
  updateCountdown();
};

saveEventsBtn.onclick = () => {
  const rows = eventList.querySelectorAll('.event-row');
  events = Array.from(rows).map(r => ({
    name: r.querySelector('.ename').value,
    date: r.querySelector('.edate').value
  }));
  displayUnits = Array.from(document.querySelectorAll('#unitSelect input:checked')).map(i => i.value);
  saveToLocalStorage();
  updateCountdown();
  closeModalFn();
};

function renderEventList(){
  eventList.innerHTML = "";
  events.forEach((ev, idx)=>{
    const div = document.createElement('div');
    div.className = 'event-row';
    div.innerHTML = `
      <input type="text" class="ename" value="${ev.name}">
      <input type="datetime-local" class="edate" value="${ev.date}">
      <button onclick="deleteEvent(${idx})">ðŸ—‘</button>
    `;
    eventList.appendChild(div);
  });
  document.querySelectorAll('#unitSelect input').forEach(ch=>{
    ch.checked = displayUnits.includes(ch.value);
  });
}
window.deleteEvent = (idx) => {
  events.splice(idx,1);
  renderEventList();
};

function updateCountdown(){
  if(events.length===0)return;
  const targetDate = new Date(events[currentEventIndex].date);
  eventTitle.textContent = events[currentEventIndex].name;
  const now = new Date();
  let diff = targetDate - now;
  if(diff <= 0){
    currentEventIndex++;
    if(currentEventIndex >= events.length) currentEventIndex = 0;
    saveToLocalStorage();
    updateCountdown();
    return;
  }
  const seconds = Math.floor(diff/1000)%60;
  const minutes = Math.floor(diff/1000/60)%60;
  const hours = Math.floor(diff/1000/60/60)%24;
  const days = Math.floor(diff/1000/60/60/24)%7;
  const weeks = Math.floor(diff/1000/60/60/24/7)%4;
  const months = Math.floor(diff/1000/60/60/24/30)%12;
  const years = Math.floor(diff/1000/60/60/24/365);

  const parts = {years,months,weeks,days,hours,minutes,seconds};
  countdownContainer.innerHTML = '';
  for(const unit of displayUnits){
    const val = String(parts[unit]).padStart(2,'0');
    const flipCard = document.createElement('div');
    flipCard.className = 'flip-card';
    if(prevValues[unit] !== val){
      flipCard.classList.add('flip');
      prevValues[unit] = val;
    }
    flipCard.textContent = val;
    const label = document.createElement('div');
    label.className = 'label';
    label.textContent = unit.charAt(0).toUpperCase()+unit.slice(1);
    const wrapper = document.createElement('div');
    wrapper.appendChild(flipCard);
    wrapper.appendChild(label);
    countdownContainer.appendChild(wrapper);
  }
}
setInterval(updateCountdown, 1000);
updateCountdown();
</script>
</body>
</html>